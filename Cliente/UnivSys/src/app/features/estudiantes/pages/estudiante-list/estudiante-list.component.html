<div class="flex justify-between items-center mb-5">
  <h1 class="text-3xl font-bold text-slate-800">Dashboard de Estudiantes</h1>
  <a *ngIf="userRol && (userRol === 'Maestro' || userRol === 'Director' || userRol === 'Admin')"
     [routerLink]="['/estudiantes/nuevo']" 
     class="flex items-center py-2 px-4 rounded-lg font-semibold text-white shadow-md
            bg-indigo-600 hover:bg-indigo-700
            transition-all duration-300 ease-in-out
            focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50
            transform hover:scale-105">
    <span class="mr-2 text-xl">➕</span>
    Registrar Nuevo
  </a>
</div>

<app-estudiante-filter></app-estudiante-filter>

<div class="bg-white shadow-lg rounded-lg overflow-hidden">
  <div *ngIf="estudiantes$ | async as estudiantes; else loading">
    <table *ngIf="estudiantes.length > 0; else noData" class="w-full text-left">
      
      <thead class="bg-slate-100 text-slate-600 uppercase text-xs font-semibold">
        <tr>
          <th scope="col" class="px-6 py-4">Matrícula</th>
          <th scope="col" class="px-6 py-4">Nombre Completo</th>
          <th scope="col" class="px-6 py-4">Carrera (ID)</th>
          <th scope="col" class="px-6 py-4">Semestre</th>
          <th scope="col" class="px-6 py-4">Estado</th>
          <th scope="col" class="px-6 py-4 text-right">Acciones</th>
        </tr>
      </thead>
      
      <tbody class="text-slate-700 divide-y divide-slate-200">
        <tr *ngFor="let est of estudiantes" class="table-row-animate">
          <td class="px-6 py-4 font-medium text-slate-900 whitespace-nowrap">{{ est.idEstudiante }}</td>
          <td class="px-6 py-4">{{ est.nombres }} {{ est.apellidoPaterno }} {{ est.apellidoMaterno }}</td>
          <td class="px-6 py-4">{{ est.nombreCarrera }}</td>
          <td class="px-6 py-4">{{ est.semestre }}</td>
          <td class="px-6 py-4">
            <span *ngIf="est.esBecado" class="px-3 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">Becado</span>
            <span *ngIf="est.esEgresado" class="px-3 py-1 text-xs font-semibold rounded-full bg-teal-100 text-teal-800">Egresado</span>
            <span *ngIf="!est.esBecado && !est.esEgresado" classs="px-3 py-1 text-xs font-semibold rounded-full bg-slate-100 text-slate-800">Regular</span>
          </td>
          <td class="px-6 py-4 text-right space-x-2">
            <a [routerLink]="['/estudiantes', est.idEstudiante]" 
               class="py-1 px-3 rounded-md font-semibold text-xs 
                      bg-blue-100 text-blue-700 
                      hover:bg-blue-200 hover:shadow-sm transition-all">Ver</a>
            <a [routerLink]="['/estudiantes', est.idEstudiante, 'editar']" 
               class="py-1 px-3 rounded-md font-semibold text-xs 
                      bg-yellow-100 text-yellow-700 
                      hover:bg-yellow-200 hover:shadow-sm transition-all">Editar</a>
            <button *ngIf="canDelete()" (click)="askToDelete(est)" 
                    class="py-1 px-3 rounded-md font-semibold text-xs 
                           bg-red-100 text-red-700 
                           hover:bg-red-200 hover:shadow-sm transition-all">
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <ng-template #noData> </ng-template>
  </div>
  <ng-template #loading> </ng-template>
</div>

<app-confirm-dialog *ngIf="showConfirmDialog" ...></app-confirm-dialog>